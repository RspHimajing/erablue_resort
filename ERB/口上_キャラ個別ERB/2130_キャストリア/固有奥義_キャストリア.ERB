
@固有奥義_2130(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 奥義威力 = 0
#DIMS 奥義名
#DIM 効果数値, 2
#DIM ＯＣ補正

IF ダンジョン表示モード == "戦闘画面"
	アビ汎用変数:消費奥義ゲージ量 = BATTLE_STATE:戦闘行動キャラ:奥義ゲージ
	IF BATTLE_STATE:戦闘行動キャラ:奥義ゲージ == 200
		ＯＣ補正 = 2
		戦闘中カウント:戦闘行動キャラ:9 == 1
	ELSEIF 戦闘中カウント:戦闘行動キャラ:9 == 0
		ＯＣ補正 = 0
	ENDIF
ENDIF

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 60
	奥義名 = きみをいだく希望の星＋＋
	効果数値:0 = 50
	効果数値:1 = 3 + ＯＣ補正
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	奥義名 = きみをいだく希望の星＋
	効果数値:0 = 40
	効果数値:1 = 2 + ＯＣ補正
ELSE
	奥義名 = きみをいだく希望の星
	効果数値:0 = 30
	効果数値:1 = 1 + ＯＣ補正
ENDIF

;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰を攻撃しますか？」と表示される。
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、奥義使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の奥義：（奥義名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "奥義名"
		TSTR:コマンド名受渡 = %奥義名%
	CASE "奥義説明文"
		詳細文文字列受け渡し変数 = <br>味方全体の攻撃力(B枠)を［{効果数値:0}％/3T］上昇させる。
		詳細文文字列受け渡し変数 += "<br>弱体状態を解除"
		IF 戦闘中カウント:戦闘行動キャラ:9 == 0
			詳細文文字列受け渡し変数 += @"<br>対粛正防御状態を付与［{効果数値:1}回/3T］"
			詳細文文字列受け渡し変数 += "<br>※奥義ゲージ全消費＆奥義ゲージ200％の時性能強化"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>対粛正防御状態を付与［<font color='#%カラーパレット_HTML("黄")%'>{効果数値:1}</font>回/3T］"
			詳細文文字列受け渡し変数 += @"<br><font color='#%カラーパレット_HTML("黄")%'>※奥義ゲージ全消費＆奥義ゲージ200％の時性能強化</font>"
		ENDIF
		RETURN 奥義威力
	CASE "奥義追加効果"
		アビテンプレート用_アビ名表示済フラグ = 1
		CALL 画面再描画
		CALLFORM KOJO_DUNGEON_奥義発動時_{NO:(BATTLE_STATE:戦闘行動キャラ:キャラ登録番号)}(キャラ番号, 奥義名)
		CALL 口上変数初期化
		CALL カットイン呼出("奥義")
		WAIT
		CALL カットイン継承(1)
		CALL カットイン継承終了(1)
		WSTR:(K++) = %CALLNAME:キャラ番号%の奥義：%奥義名%！
		SIF 戦闘中カウント:戦闘行動キャラ:9 == 1
			WSTR:(K++) = <font color='#%カラーパレット_HTML("黄")%'>_I_オーバーチャージ！</font>
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用変数:効果割合 = 効果数値:0
		アビ汎用文字列:バフ・デバフ枠 = 攻撃力B
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		CALL アビ汎用変数文字列リセット
		CALL アビテンプレート_有利効果_デバフ全て消去()
		アビ汎用文字列:バフ・デバフ枠 = 対粛正防御
		アビ汎用文字列:バフ・デバフ対象能力 = 対粛正防御
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:持続回数 = 効果数値:1
		CALL アビテンプレート_有利効果_バフ効果セット
		戦闘中カウント:戦闘行動キャラ:9 = 0
ENDSELECT

@固有バフ・デバフ処理_バフ_対粛正防御_被ダメージ(隊列番号, バフ・デバフ行数, ダメージ値)
#DIM 隊列番号
#DIM バフ・デバフ行数
#DIM ダメージ値

CALL バフ回数経過処理(隊列番号, "対粛正防御")

RETURN 0

