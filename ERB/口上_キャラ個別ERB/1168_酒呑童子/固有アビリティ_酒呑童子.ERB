
@固有アビ_1168_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIMS 効果数値

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 24
	アビ名 = 果実の酒気＋＋
	消費ＭＰ = 50
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 12
	アビ名 = 果実の酒気＋
	消費ＭＰ = 45
ELSE
	アビ名 = 果実の酒気
	消費ＭＰ = 40
ENDIF



;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 


SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>声色や吐息から香る蕩けるような果実の酒気で
		詳細文文字列受け渡し変数 += @"<br>敵全体を誘惑し、60％の確率で魅了を付与する［1ターン］"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 24
			詳細文文字列受け渡し変数 += @"<br>更に、防御力を低下させる［20％/3ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 12
			詳細文文字列受け渡し変数 += @"<br>更に、防御力を低下させる［15％/3ターン］"
		ELSE
			詳細文文字列受け渡し変数 += @"<br>更に、防御力を低下させる［10％/3ターン］"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 果実の酒気_魅了
		アビ汎用文字列:バフ・デバフ対象能力 = 魅了
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:持続ターン = 1
		アビ汎用変数:基礎成功確率 = 60
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 果実の酒気_防御減
		アビ汎用文字列:バフ・デバフ対象能力 = 防御力
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 100
		
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 24
			アビ汎用変数:効果割合 = 20
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 12
			アビ汎用変数:効果割合 = 15
		ELSE
			アビ汎用変数:効果割合 = 10
		ENDIF

		CALL アビテンプレート_不利効果_デバフ効果セット
		
ENDSELECT

@固有アビ_1168_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
	アビ名 = 鬼種の魔＋＋
	消費ＭＰ = 40
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
	アビ名 = 鬼種の魔＋
	消費ＭＰ = 40
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
	アビ名 = 鬼種の魔
	消費ＭＰ = 40
ENDIF



;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 


SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>味方全体の攻撃力上昇
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
			詳細文文字列受け渡し変数 += @"	［20％/3ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
			詳細文文字列受け渡し変数 += @"	［15％/3ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
			詳細文文字列受け渡し変数 += @"	［10％/3ターン］"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>自身の奥義威力上昇"
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
			詳細文文字列受け渡し変数 += @"	［30％/3ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
			詳細文文字列受け渡し変数 += @"	［25％/3ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
			詳細文文字列受け渡し変数 += @"	［20％/3ターン］"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 鬼種の魔_攻撃力
		アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
		アビ汎用変数:持続ターン = 3
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
			アビ汎用変数:効果割合 = 20
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
			アビ汎用変数:効果割合 = 15
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
			アビ汎用変数:効果割合 = 10
		ENDIF
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 鬼種の魔_奥義威力
		アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_奥義ダメージ
		アビ汎用変数:持続ターン = 3
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 28
			アビ汎用変数:効果割合 = 30
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
			アビ汎用変数:効果割合 = 25
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 4
			アビ汎用変数:効果割合 = 20
		ENDIF
		CALL アビテンプレート_有利効果_バフ効果セット
		
ENDSELECT

@固有アビ_1168_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 隊列番号

隊列番号 = キャラ隊列検索(キャラ番号)

;レベルなどの条件でアビを強化する場合、アビ名の文字列を条件分岐で変化させる
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = 鬼の首＋
	消費ＭＰ = 30
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = 鬼の首
	消費ＭＰ = 30
	
ENDIF

;スキル使用時に記録したターン数と比較して、CTが過ぎているか確認
SIF 隊列番号 > -1 && 戦闘中カウント:隊列番号:0 != 0 && 現在ターン数 < (戦闘中カウント:隊列番号:0 + 4)
	アビテンプレート用_アビ封印用フラグ = 1

;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 


SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自己にガッツ（自動復活効果）を付与する
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
						詳細文文字列受け渡し変数 += @"［HP3000/5ターン］"
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
						詳細文文字列受け渡し変数 += @"［HP2000/5ターン］"
		ENDIF
		詳細文文字列受け渡し変数 += @"<br>ガッツが発動した際、奥義ゲージ上昇。"
		詳細文文字列受け渡し変数 += @"<br>使用後5ターン使用不能"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 鬼の首
		アビ汎用文字列:バフ・デバフ対象能力 = 鬼の首
		アビ汎用変数:持続ターン = 5
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
			アビ汎用変数:効果量 = 3000
		ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			アビ汎用変数:効果量 = 2000
		ENDIF
		CALL アビテンプレート_有利効果_バフ効果セット
		
		;CTの設定の為のターン数の記録
		戦闘中カウント:隊列番号:0 = 現在ターン数
				
ENDSELECT

@固有戦闘不能時処理_バフ_鬼の首(バフ・デバフ行数)
;行動開始時処理関数から呼び出し
#DIM バフ・デバフ行数
#DIM キャラ番号
#DIM 復活判定

;復活部分
CALL アビ対象選択テンプレート_自己のみ
アビ汎用変数:蘇生可能オプション = 1
アビ汎用変数:阻害無視オプション = 1
アビ汎用変数:効果量 = DT_CELL_GET("戦闘効果データベース", バフ・デバフ行数, "効果量_固定値")
CALL アビテンプレート_回復処理_MAXでも回復

;ゲージ上昇部分
CALL アビ汎用変数文字列リセット
アビ汎用変数:効果量 = 30
CALL アビテンプレート_有利効果_奥義ゲージUP

;バフの削除
CALL アビ汎用変数文字列リセット
CALL アビテンプレート_不利効果_バフ消去("鬼の首")

;----------------------------------------------------------------------------------
;アビリティテンプレート例
;----------------------------------------------------------------------------------
;敵単体に、攻撃力の200%威力で火属性のダメージを与える効果
;----------------------------------------------------------------------------------	
	; CALL アビ対象選択テンプレート_敵単体
	; アビ汎用変数:効果割合 = 200
	; CALL アビテンプレート_ダメージ処理_火属性

;----------------------------------------------------------------------------------
;戦闘不能ではない敵全体に、防御力の300%威力で自属性のダメージを与える効果
;----------------------------------------------------------------------------------	
	; CALL アビ対象選択テンプレート_敵全体_生者のみ
	; アビ汎用変数:効果割合 = 300
	; アビ汎用文字列:攻撃側使用能力値 = 防御力
	; CALL アビテンプレート_ダメージ処理_自属性

;----------------------------------------------------------------------------------
;戦闘不能ではない味方全体に、3ターン持続する30%の攻撃力UPを与える効果
;----------------------------------------------------------------------------------
	; CALL アビ対象選択テンプレート_味方全体_生者のみ
	; アビ汎用変数:効果割合 = 30
	; アビ汎用文字列:バフ・デバフ枠 = 攻撃力A
	; アビ汎用文字列:バフ・デバフ対象能力 = 攻撃力
	; アビ汎用変数:持続ターン = 3
	; CALL アビテンプレート_有利効果_バフ効果セット

;----------------------------------------------------------------------------------
;敵縦列に、3ターン持続する暗闇（攻撃失敗率40%）を与える効果　基礎成功率70％
;----------------------------------------------------------------------------------
	; CALL アビ対象選択テンプレート_敵縦列
	; アビ汎用変数:効果割合 = 40
	; アビ汎用文字列:バフ・デバフ枠 = 暗闇
	; アビ汎用文字列:バフ・デバフ対象能力 = 暗闇
	; アビ汎用変数:持続ターン = 3
	; アビ汎用変数:基礎成功確率 = 70
	; CALL アビテンプレート_不利効果_デバフ効果セット

;----------------------------------------------------------------------------------
;戦闘不能状態の味方単体を蘇生し、回復力の100%威力でHPを回復する効果
;----------------------------------------------------------------------------------	
	; CALL アビ対象選択テンプレート_味方単体_死者のみ
	; アビ汎用変数:効果割合 = 100
	; アビ汎用変数:蘇生可能オプション = 1
	; CALL アビテンプレート_回復処理


;--------------------------------------------------
;戦闘能力の固有処理説明
;--------------------------------------------------
; @口上_ステータス画面_固有特性解説_XXXX(対象キャラ)
; #DIM 対象キャラ
; CALL 口上変数初期化

; ;口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
; ;基本的にWAIT系列は使わないことを推奨

; KSTR:(K++) = □ 特性 □-------------------------------------------------------------------------------
; KSTR:(K++) = 　
; KSTR:(K++) = 　
; KSTR:(K++) = 　
; KSTR:(K++) = 　

; CALL 口上変数表示(対象キャラ, 1)
