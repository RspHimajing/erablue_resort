@固有アビ_1344_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 威力

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 32
	アビ名 = 狂笑＋＋
	威力 = 130
	消費ＭＰ = 40
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
	アビ名 = 狂笑＋
	威力 = 115
	消費ＭＰ = 25
ELSE
	アビ名 = 狂笑
	威力 = 100
	消費ＭＰ = 10
ENDIF

;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}
		詳細文文字列受け渡し変数 += @"<br>{威力}％の自属性ダメージを与えながら、相手に「釘」を1付与［上限15本］"
		詳細文文字列受け渡し変数 += @"<br>更に［20％］（Ｃ枠・3ターン）の命中率・回避率減少効果を与える。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		
		アビ汎用文字列:バフ・デバフ対象能力 = 釘
		アビ汎用変数:累積上限_固定値 = 15
		CALL アビテンプレート_刻印追加(1)
		
		アビ汎用変数:効果割合 = 威力
		CALL アビテンプレート_ダメージ処理_自属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 20
		アビ汎用文字列:バフ・デバフ枠 = 命中率C
		アビ汎用文字列:バフ・デバフ対象能力 = 命中率
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_デバフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 20
		アビ汎用文字列:バフ・デバフ枠 = 回避率C
		アビ汎用文字列:バフ・デバフ対象能力 = 回避率
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 100
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT



@固有アビ_1344_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 威力
#DIM アビ効果成功率

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 32
	アビ名 = 握る者の注視＋＋
	威力 = 140
	アビ効果成功率 = 80
	消費ＭＰ = 40
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 16
	アビ名 = 握る者の注視＋
	威力 = 120
	アビ効果成功率 = 70
	消費ＭＰ = 25
ELSE
	アビ名 = 握る者の注視
	威力 = 110
	アビ効果成功率 = 60
	消費ＭＰ = 10
ENDIF

;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}
		詳細文文字列受け渡し変数 += @"<br>{威力}％の自属性ダメージを与えながら、相手に「釘」を3付与［上限15本］"
		詳細文文字列受け渡し変数 += @"<br>更に［100％］（通常枠・2ターン）の麻痺効果を与える。成功率{アビ効果成功率}％。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ対象選択テンプレート_敵単体
		
		アビ汎用文字列:バフ・デバフ対象能力 = 釘
		アビ汎用変数:累積上限_固定値 = 15
		CALL アビテンプレート_刻印追加(3)
		
		アビ汎用変数:効果割合 = 威力
		CALL アビテンプレート_ダメージ処理_自属性
		
		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 麻痺
		アビ汎用文字列:バフ・デバフ対象能力 = 麻痺
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:持続ターン = 2
		アビ汎用変数:基礎成功確率 = アビ効果成功率
		CALL アビテンプレート_不利効果_デバフ効果セット
ENDSELECT



@固有アビ_1344_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 威力

;実はコレだけ握る者ファウストのパッシブスキルが元ネタ
;あとLimbus Companyの「釘」による出血再現も込み
IF 基礎BATTLE_STATE:キャラ番号:Lv >= 40
	アビ名 = 口笛
	威力 = 40
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
	アビ名 = 口笛
	威力 = 25
ELSE
	アビ名 = 口笛
	威力 = 20
ENDIF
消費ＭＰ = 50

;下の４つの文字列に文章を入れると、対象選択時の文章を変化させることが出来る。
;これらを使わない場合は「誰に使用しますか？」と表示される。		
;アビ汎用文字列:選択時メッセージ１ = 
;アビ汎用文字列:選択時メッセージ２ = 
;アビ汎用文字列:選択時メッセージ３ = 
;アビ汎用文字列:選択時メッセージ４ = 

;下の４つの文字列に文章を入れると、アビ使用時の文章を変化させることが出来る。
;これらを使わない場合は「（キャラ名）の（アビ名）！」と表示される。
;アビ汎用文字列:実行時メッセージ１ = 
;アビ汎用文字列:実行時メッセージ２ = 
;アビ汎用文字列:実行時メッセージ３ = 
;アビ汎用文字列:実行時メッセージ４ = 

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			詳細文文字列受け渡し変数 += @"味方全体"
		ELSE
			詳細文文字列受け渡し変数 += @"ランダムな味方２体"
		ENDIF
		詳細文文字列受け渡し変数 += @"に［30％］（Ｃ枠・3ターン）の命中率・回避率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>その後、敵全体に自傷効果［「釘」の本数✕{威力}/3ターン］"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		;まずはバフから
		IF 基礎BATTLE_STATE:キャラ番号:Lv >= 20
			CALL アビ対象選択テンプレート_味方全体_生者のみ
		ELSE
			CALL アビ対象選択テンプレート_味方ランダムＸ体_重複無し(2)
		ENDIF
		アビ汎用変数:効果割合 = 30
		アビ汎用文字列:バフ・デバフ枠 = 命中率C
		アビ汎用文字列:バフ・デバフ対象能力 = 命中率
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		
		CALL アビ汎用変数文字列リセット
		アビ汎用変数:効果割合 = 30
		アビ汎用文字列:バフ・デバフ枠 = 回避率C
		アビ汎用文字列:バフ・デバフ対象能力 = 回避率
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット
		
		;次に敵へのデバフ付与
		CALL アビ汎用変数文字列リセット
		FOR LOCAL, 0, 10
			SIF 敵BATTLE_STATE_STR:LOCAL:エネミー名 == ""
				CONTINUE
			;生者のみ
			SIF 敵BATTLE_STATE:LOCAL:ＨＰ < 1
				CONTINUE
			;刻印あるかどうか
			SIF 刻印現在数確認("釘", LOCAL + 10) <= 0
				CONTINUE
			CALL アビ対象選択テンプレート_指定(LOCAL + 10, 0)
			アビ汎用文字列:バフ・デバフ枠 = 出血
			アビ汎用文字列:バフ・デバフ対象能力 = 自傷
			アビ汎用変数:効果量 = 刻印現在数確認("釘", LOCAL + 10) * 威力
			アビ汎用変数:持続ターン = 3
			アビ汎用変数:基礎成功確率 = 100
			CALL アビテンプレート_不利効果_デバフ効果セット
		NEXT
ENDSELECT



@固有バフ・デバフ処理_キャラ_1344_与ダメージ(隊列番号, ダメージ値)
#DIM 隊列番号
#DIM ダメージ値

;対象の種族に機械があるなら
IF 戦闘行動対象 >= 10 && STRFINDU(敵BATTLE_STATE_STR:(戦闘行動対象 - 10):種族, "機械") >= 0
	;ダメージ１．３倍
	RETURN ダメージ値 * 13 / 10
ENDIF

;上に引っかからなかったらダメージをそのまま返す
RETURN ダメージ値


;--------------------------------------------------
;戦闘能力の固有処理説明
;--------------------------------------------------
@口上_ステータス画面_固有特性解説_1344(対象キャラ)
#DIM 対象キャラ
CALL 口上変数初期化

;口上と同じ感覚で使う為に書式を統一しているが、ステータス画面で表示されるので
;基本的にWAIT系列は使わないことを推奨

KSTR:(K++) = □ 特性：『異端審問官』 □-------------------------------------------------------------------------------
KSTR:(K++) = 　機械系の敵に対して与えるダメージが1.3倍になる。
; KSTR:(K++) = 　
; KSTR:(K++) = 　
; KSTR:(K++) = 　

CALL 口上変数表示(対象キャラ, 1)
