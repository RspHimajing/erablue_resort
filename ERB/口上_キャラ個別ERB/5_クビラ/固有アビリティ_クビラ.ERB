@固有アビ_5_1(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM 効果数値
#DIM バフ・デバフ行数

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 55
	アビ名 = 迅雷風烈＋
	消費ＭＰ = 120
	効果数値 = 400
ELSE
	アビ名 = 迅雷風烈
	消費ＭＰ = 150
	効果数値 = 200
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕{効果数値}％］の光属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>［25％］（Ａ枠・3ターン）の光耐性減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>自身に（独自枠・3ターン・消去不可）の大烈風効果を与える。"
		IF アビ名 == "迅雷風烈＋"
			詳細文文字列受け渡し変数 += @"<br>味方全体にクリティカル性能上昇効果を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵全体に［攻撃力✕{効果数値}％］の光属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>［25％］（通常枠・3ターン）の光耐性減少効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>自身に（独自枠・3ターン・消去不可）の大烈風効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>（大烈風："
		詳細文文字列受け渡し変数 += @"<br>　通常攻撃後に敵全体に［攻撃力✕150％］の光属性ダメージを与え、「臥猪の矛」を得る状態）"
		詳細文文字列受け渡し変数 += @"<br>（臥猪の矛："
		詳細文文字列受け渡し変数 += @"<br>　4つ以上スタックしたターン終了時にアビリティ「猪突猛進」が発動し、「臥猪の矛」のスタック数を4下げる状態）"
		IF アビ名 == "迅雷風烈＋"
			詳細文文字列受け渡し変数 += @"<br>味方全体に［70％］（Ａ枠・3ターン）のクリティカル率上昇効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［30％］（Ａ枠・3ターン）のクリティカルダメージ率上昇効果を与える。"
		ENDIF
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用変数:効果割合 = 効果数値
		CALL アビテンプレート_ダメージ処理_光属性
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 属性被ダメージ_光
		アビ汎用文字列:バフ・デバフ対象能力 = 属性被ダメージ_光
		アビ汎用変数:効果量 = 25
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:基礎成功確率 = 90
		CALL アビテンプレート_不利効果_デバフ効果セット

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 大烈風
		アビ汎用文字列:バフ・デバフ対象能力 = 大烈風
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		IF アビ名 == "迅雷風烈＋"
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = クリティカル率A
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカル率
			アビ汎用変数:効果量 = 70
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット

			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_味方全体_生者のみ
			アビ汎用文字列:バフ・デバフ枠 = クリティカルダメージ率A
			アビ汎用文字列:バフ・デバフ対象能力 = クリティカルダメージ率
			アビ汎用変数:効果量 = 30
			アビ汎用変数:持続ターン = 3
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
ENDSELECT

@固有アビ_5_2(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM バフ・デバフ行数

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 50
	アビ名 = 猪突猛進＋
	消費ＭＰ = 50
ELSE
	アビ名 = 猪突猛進
	消費ＭＰ = 70
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕400％］の光属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>味方全体に（3ターン・消去不可）の猪突猛進効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>◆使用回数に応じて強化効果性能UP［最大5回］"
		RETURN 消費ＭＰ
	CASE "アビ説明文_詳細"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>敵単体に［攻撃力✕400％］の光属性ダメージを与える。
		詳細文文字列受け渡し変数 += @"<br>味方全体に（3ターン・消去不可）の猪突猛進効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［アビリティ猪突猛進の使用回数✕5％］の連続攻撃率上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>＞［アビリティ猪突猛進の使用回数✕3％］の通常攻撃ダメージ上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>アビリティ猪突猛進の使用回数は5回までカウントする。"
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_敵単体
		アビ汎用変数:効果割合 = 400
		CALL アビテンプレート_ダメージ処理_光属性

		SIF 戦闘中カウント:戦闘行動キャラ:0 < 5
			戦闘中カウント:戦闘行動キャラ:0 += 1

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_味方全体_生者のみ
		アビ汎用文字列:バフ・デバフ枠 = 猪突猛進
		アビ汎用文字列:バフ・デバフ対象能力 = 猪突猛進
		アビ汎用変数:持続ターン = 3
		アビ汎用変数:消去不可オプション = 1
		アビ汎用変数:特殊表示オプション = 1
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 猪突猛進_連続攻撃率
		アビ汎用文字列:バフ・デバフ対象能力 = 連続攻撃率
		アビ汎用変数:効果量 = 戦闘中カウント:戦闘行動キャラ:0 * 5
		CALL アビテンプレート_有利効果_付随バフ効果セット("猪突猛進")

		CALL アビ汎用変数文字列リセット
		アビ汎用文字列:バフ・デバフ枠 = 猪突猛進_通常攻撃ダメージ
		アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_通常攻撃ダメージ
		アビ汎用変数:効果量 = 戦闘中カウント:戦闘行動キャラ:0 * 3
		CALL アビテンプレート_有利効果_付随バフ効果セット("猪突猛進")
ENDSELECT

@固有アビ_5_3(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM バフ・デバフ行数
#DIM Lv閾値 = 15, 40

IF 基礎BATTLE_STATE:キャラ番号:Lv >= Lv閾値:1
	アビ名 = 英華発外＋
	消費ＭＰ = 35
ELSEIF 基礎BATTLE_STATE:キャラ番号:Lv >= Lv閾値:0
	アビ名 = 英華発外
	消費ＭＰ = 50
ELSE
	アビ名 = 	
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>自身に［攻撃力✕100％］（通常枠・3回or3ターン）のカウンター効果を与える。
		詳細文文字列受け渡し変数 += @"<br>［60％］（Ａ枠・3ターン）の敵対心上昇効果を与える。"
		詳細文文字列受け渡し変数 += @"<br>［5％］（独自枠・3ターン）の被ダメージ時に奥義ゲージが増加する効果を与える。"
		IF アビ名 == "英華発外＋"
			詳細文文字列受け渡し変数 += @"<br>（1ターン）の全体かばう効果を与える。"
			詳細文文字列受け渡し変数 += @"<br>［ＨＰ1］（通常枠・1回or1ターン）の自動復活効果を与える。"
		ENDIF
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = カウンター
		アビ汎用文字列:バフ・デバフ対象能力 = カウンター
		アビ汎用変数:効果割合 = 100
		アビ汎用変数:持続回数 = 3
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 敵対心A
		アビ汎用文字列:バフ・デバフ対象能力 = 敵対心
		アビ汎用変数:効果量 = 60
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用文字列:バフ・デバフ枠 = 英華発外
		アビ汎用文字列:バフ・デバフ対象能力 = 特殊反応_被ダメ時
		アビ汎用変数:持続ターン = 3
		CALL アビテンプレート_有利効果_バフ効果セット

		IF アビ名 == "英華発外＋"
			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 全体かばう
			アビ汎用文字列:バフ・デバフ対象能力 = 全体かばう
			アビ汎用変数:持続ターン = 1
			CALL アビテンプレート_有利効果_バフ効果セット

			CALL アビ汎用変数文字列リセット
			CALL アビ対象選択テンプレート_自己のみ
			アビ汎用文字列:バフ・デバフ枠 = 自動復活
			アビ汎用文字列:バフ・デバフ対象能力 = 自動復活
			アビ汎用変数:効果量 = 1
			アビ汎用変数:持続回数 = 1
			アビ汎用変数:持続ターン = 1
			CALL アビテンプレート_有利効果_バフ効果セット
		ENDIF
ENDSELECT


@固有アビ_5_4(ARGS, キャラ番号)
#DIM キャラ番号
#DIM 消費ＭＰ
#DIMS アビ名
#DIM バフ・デバフ行数
#DIM 判定値
#DIM CONST 使用可能ターン = 6

IF 基礎BATTLE_STATE:キャラ番号:Lv >= 30
	アビ名 = 亥気衝天
	消費ＭＰ = 250
ELSE
	アビ名 = 
ENDIF

IF キャラ隊列検索(GETCHARA(5)) > -1
	判定値 = 現在ターン数
	SIF 判定値 < 使用可能ターン
		アビテンプレート用_アビ封印用フラグ = 1
ENDIF

SELECTCASE ARGS
	CASE "アビ名"
		TSTR:コマンド名受渡 = %アビ名%
	CASE "アビ説明文"
		詳細文文字列受け渡し変数 = 消費ＭＰ：{消費ＭＰ}<br>ランダムな敵単体に［攻撃力✕200％］の光属性ダメージを24回与える。
		詳細文文字列受け渡し変数 += @"<br>自身に［2000］のＨＰ回復を与える。"
		詳細文文字列受け渡し変数 += @"<br>［1］の弱体回復を与える。"
		RETURN 消費ＭＰ
	CASE "アビ効果"
		CALL アビ汎用変数文字列リセット
				CALL アビ汎用変数文字列リセット
			FOR LOCAL, 0, 24
				アビ汎用変数:敵対心無視オプション = 1
				CALL アビ対象選択テンプレート_敵ランダムＸ体(1)
				アビ汎用変数:効果割合 = 200
				CALL アビテンプレート_ダメージ処理_光属性
			NEXT

		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		アビ汎用変数:効果量 = 2000
		CALL アビテンプレート_回復処理_MAXでも回復
		
		CALL アビ汎用変数文字列リセット
		CALL アビ対象選択テンプレート_自己のみ
		CALL アビテンプレート_有利効果_デバフ消去
ENDSELECT


@固有戦闘開始時処理_キャラ_5
#DIM バフ・デバフ行数
#DIM 隊列番号
#DIM 対象番号

CALL アビ対象選択テンプレート_自己のみ
アビ汎用文字列:バフ・デバフ枠 = 亥神宮の主
アビ汎用文字列:バフ・デバフ対象能力 = 特殊反応_被ダメ時
アビ汎用変数:持続ターン = -1
アビ汎用変数:消去不可オプション = 1
アビ汎用変数:特殊表示オプション = 1
CALL アビテンプレート_有利効果_パッシブバフ効果セット


CALL アビ対象選択テンプレート_自己のみ
CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猪突・上宝沁金ノ撃槍
アビ汎用文字列:バフ・デバフ対象能力 = 猪突・上宝沁金ノ撃槍
アビ汎用変数:持続ターン = -1
アビ汎用変数:消去不可オプション = 1
アビ汎用変数:特殊表示オプション = 1
CALL アビテンプレート_有利効果_パッシブバフ効果セット

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猪突・上宝沁金ノ撃槍_通常攻撃ダメージ
アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_通常攻撃ダメージ
アビ汎用変数:効果割合 = 15
CALL アビテンプレート_有利効果_付随バフ効果セット("猪突・上宝沁金ノ撃槍")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猪突・上宝沁金ノ撃槍_最大ＨＰ
アビ汎用文字列:バフ・デバフ対象能力 = 最大ＨＰ
アビ汎用変数:効果割合 = 20
CALL アビテンプレート_有利効果_付随バフ効果セット("猪突・上宝沁金ノ撃槍")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猪突・上宝沁金ノ撃槍_防御力
アビ汎用文字列:バフ・デバフ対象能力 = 防御力
アビ汎用変数:効果割合 = 30
CALL アビテンプレート_有利効果_付随バフ効果セット("猪突・上宝沁金ノ撃槍")

CALL アビ汎用変数文字列リセット
アビ汎用文字列:バフ・デバフ枠 = 猪突・上宝沁金ノ撃槍_ゲージ上昇効率
アビ汎用文字列:バフ・デバフ対象能力 = ゲージ上昇効率
アビ汎用変数:効果割合 = 35
CALL アビテンプレート_不利効果_付随デバフ効果セット("猪突・上宝沁金ノ撃槍")

CALL アビテンプレ変数リセット


@特殊反応_被ダメ時_亥神宮の主(バフ番号, 攻撃者隊列, 被ダメ記録順)
#DIM バフ・デバフ行数
#DIM 隊列番号
#DIM 臥猪の矛
#DIM 被ダメ記録順
#DIM 攻撃者隊列
#DIM バフ番号

隊列番号 = キャラ隊列検索(GETCHARA(5))
臥猪の矛 = 刻印現在数確認("臥猪の矛", 隊列番号)
バフ・デバフ行数 = バフ番号取得_枠("亥神宮の主", 隊列番号)

IF バフ・デバフ行数 > -1
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 臥猪の矛
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印追加(1)
ENDIF


@特殊反応_被ダメ時_英華発外(バフ番号, 攻撃者隊列, 被ダメ記録順)
#DIM バフ・デバフ行数
#DIM 隊列番号
#DIM 被ダメ記録順
#DIM 攻撃者隊列
#DIM バフ番号

隊列番号 = キャラ隊列検索(GETCHARA(5))
バフ・デバフ行数 = バフ番号取得_枠("英華発外", 隊列番号)

IF バフ・デバフ行数 > -1
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用変数:効果量 = 8
	CALL アビテンプレート_有利効果_奥義ゲージUP
ENDIF


@固有通常攻撃後処理_キャラ_5(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM 隊列番号
#DIM バフ・デバフ行数
#DIM 臥猪の矛

SIF 全滅フラグ
	RETURN 0

隊列番号 = キャラ隊列検索(GETCHARA(5))
バフ・デバフ行数 = バフ番号取得_枠("大烈風", 隊列番号)
臥猪の矛 = 刻印現在数確認("臥猪の矛", 隊列番号)

IF バフ・デバフ行数 > -1
	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_敵全体_生者のみ
	アビ汎用変数:効果割合 = 150
	CALL アビテンプレート_ダメージ処理_光属性

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 臥猪の矛
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印追加(1)
ENDIF


@固有ターン終了時処理_キャラ_5(全滅フラグ, 連撃数)
#DIM 連撃数
#DIM 全滅フラグ
#DIM 隊列番号
#DIM バフ・デバフ行数
#DIM 臥猪の矛
#DIMS 猪突猛進

SIF 全滅フラグ
	RETURN 0

隊列番号 = キャラ隊列検索(GETCHARA(5))
臥猪の矛 = 刻印現在数確認("臥猪の矛", 隊列番号)

IF 臥猪の矛 >= 4
	アビテンプレート用_アビ名 = 猪突猛進

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_敵ランダムＸ体(1)
	アビ汎用変数:効果割合 = 400
	CALL アビテンプレート_ダメージ処理_光属性

	SIF 戦闘中カウント:戦闘行動キャラ:0 < 5
		戦闘中カウント:戦闘行動キャラ:0 += 1

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_味方全体_生者のみ
	アビ汎用文字列:バフ・デバフ枠 = 猪突猛進
	アビ汎用文字列:バフ・デバフ対象能力 = 猪突猛進
	アビ汎用変数:持続ターン = 3
	アビ汎用変数:消去不可オプション = 1
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_有利効果_バフ効果セット

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 猪突猛進_連続攻撃率
	アビ汎用文字列:バフ・デバフ対象能力 = 連続攻撃率
	アビ汎用変数:効果量 = 戦闘中カウント:戦闘行動キャラ:0 * 5
	CALL アビテンプレート_有利効果_付随バフ効果セット("猪突猛進")

	CALL アビ汎用変数文字列リセット
	アビ汎用文字列:バフ・デバフ枠 = 猪突猛進_通常攻撃ダメージ
	アビ汎用文字列:バフ・デバフ対象能力 = ダメージ補正_通常攻撃ダメージ
	アビ汎用変数:効果量 = 戦闘中カウント:戦闘行動キャラ:0 * 3
	CALL アビテンプレート_有利効果_付随バフ効果セット("猪突猛進")

	CALL アビ汎用変数文字列リセット
	CALL アビ対象選択テンプレート_自己のみ
	アビ汎用文字列:バフ・デバフ対象能力 = 臥猪の矛
	アビ汎用変数:特殊表示オプション = 1
	CALL アビテンプレート_刻印減少(4)
ENDIF



@バフ・デバフ特殊表示_亥神宮の主(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 亥神宮の主
PRINTFORML 被ダメ―ジ時に「臥猪の矛」を得る
PRINTFORML 持続ターン：永続


@バフ・デバフ特殊表示_猪突・上宝沁金ノ撃槍(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 猪突・上宝沁金ノ撃槍
PRINTFORML 奥義ゲージが溜まりにくいが通常攻撃の与ダメ―ジが高い。最大HPと防御力が増加
PRINTFORML 持続ターン：永続


@バフ・デバフ特殊表示_臥猪の矛(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 臥猪の矛
PRINTFORML 4つ以上スタックしたターン終了時に「猪突猛進」が発動し、「臥猪の矛」のスタック数を4下げる


@バフ・デバフ特殊表示_大烈風(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 大烈風
PRINTFORML 通常攻撃後に敵全体に光属性[攻撃力✕150％]ダメージが発生し、「臥猪の矛」を得る状態[3ターン/消去不可]


@バフ・デバフ特殊表示_猪突猛進(隊列番号, バフ・デバフ行数)
#DIM 隊列番号
#DIM バフ・デバフ行数
VARSET LOCALS

PRINTFORML 猪突猛進
PRINTFORML 味方全体の連続攻撃確率と、通常攻撃の与ダメージがUP[3ターン/消去不可]


@探索欄表示_キャラ_5(レイヤー番号, 隊列番号)
#DIM 隊列番号
#DIM レイヤー番号

GDRAWTEXT レイヤー番号, "臥猪の矛:", 120, 90
GSETBRUSH レイヤー番号, 属性数値文字色変換_透明度込(BATTLE_STATE:隊列番号:属性)
GDRAWTEXT レイヤー番号, @"Ū{刻印現在数確認("臥猪の矛", 隊列番号)}", 200, 90
