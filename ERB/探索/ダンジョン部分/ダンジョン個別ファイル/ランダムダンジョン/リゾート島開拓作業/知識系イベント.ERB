
@イベント_リゾート島開拓作業_ランダム_調合知識イベ１
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその葉っぱがポーションに使われる薬草になることに気づいた。
		WSTR:(K++) = この場で調合すれば即席のポーションとして使えるだろう。
		WSTR:(K++) = 日持ちしない薬草のためこの探索中にしか持たないが、十分役立つはずだ。
		LOCAL:1 = RAND:3 + 1
		KSTR:(K++) = %CALLNAME:PLAYER%たちは「即席オールポーション」を{LOCAL:1}個に手に入れた！
		CALL アイテム増減汎用処理("即席オールポーション", LOCAL:1)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_調合知識イベ２
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその木が魔力を貯蔵する実を付けていることに気づいた。
		WSTR:(K++) = 収穫してしまうとすぐに魔力は霧散してしまうが、この場で回復するには問題ない。
		LOCAL:1 = RAND:3 + 1
		KSTR:(K++) = %CALLNAME:PLAYER%たちのＭＰが{LOCAL:1 * 50}回復した！
		CALL 探索中全体回復_ＭＰ(LOCAL:1 * 50)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_調合知識イベ３
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 妙な形の葉っぱを付けた低木の群生地を見つけた。
	CALL 知識技能所持者検索("調合知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		WSTR:(K++) = %CALLNAME:LOCAL%はその葉っぱが一時的な魔力向上薬になることに気づいた。
		WSTR:(K++) = 調合した薬を飲むと、君たちの体に力が漲る！
		KSTR:(K++) = %CALLNAME:PLAYER%たちの奥義が即座に発動可能になった！
		CALL 探索中全体回復_奥義ゲージ(100)
		ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	ELSE
		WSTR:(K++) = %CALLNAME:PLAYER%たちにはそれ以上のことはわからなかった。
		KSTR:(K++) = 調合知識があればどんな樹木かわかったかもしれないが……。
	ENDIF
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ１
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%が鑑定したところ、どうやら騎空艇の動力になる風の魔石のようだ。
				WSTR:(K++) = 持ち帰って売ればそこそこの金になるだろう！
				KSTR:(K++) = %CALLNAME:PLAYER%たちは５万ルピを手に入れた。
				MONEY += 50000
			ELSE
				WSTR:(K++) = 何かはわからないが、綺麗な魔石だ。
				WSTR:(K++) = 持ち帰って売れば換金出来るかもしれない。
				KSTR:(K++) = %CALLNAME:PLAYER%たちは１万ルピを手に入れた。
				MONEY += 10000
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ２
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = 近づいてみると、%CALLNAME:LOCAL%はそれが火の魔石であることに気づいた。
				WSTR:(K++) = うっかり触っていたら炎が噴き出して怪我をしてしまっていただろう。
				WSTR:(K++) = %CALLNAME:LOCAL%は魔石から余計な魔力を取り除き、魔石を簡単な道具として加工した。
				LOCAL:1 = RAND:3 + 1
				KSTR:(K++) = %CALLNAME:PLAYER%たちは「火の魔石」を{LOCAL:1}個に手に入れた！
				CALL アイテム増減汎用処理("火の魔石", LOCAL:1)
			ELSE
				WSTR:(K++) = 近づいてみると、突然魔石から炎が噴き出した！！
				ダメージ量 = ＰＴ内最大レベル算出() * 20
				KSTR:(K++) = %CALLNAME:PLAYER%たち全員のＨＰに{ダメージ量}のダメージ！

				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				CALL 探索中全体ダメージ_ＨＰ_致死(ダメージ量)

				WSTR:(K++) = どうやら火の魔石に魔力が溜まりすぎていたようだ。
				WSTR:(K++) = 魔力を使い切った魔石はただの石ころになってしまっている……。
				KSTR:(K++) = 魔法知識があれば防げたかもしれないが……気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔法知識イベ３
CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 岩の陰に魔力を感じる石を見つけた。
	KSTR:(K++) = 拾ってみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			CALL 知識技能所持者検索("魔法知識", 1)
			LOCAL = RESULT
			IF LOCAL > -1
				WSTR:(K++) = 近づいてみると、%CALLNAME:LOCAL%はそれが光の魔石であることに気づいた。
				WSTR:(K++) = 生命を司る魔力が治癒の力を大きく増加させる……！
				WSTR:(K++) = %CALLNAME:LOCAL%は魔石の魔力を使い、戦闘不能を含む全員のＨＰを１００回復した！
				CALL 探索中全体回復_ＨＰ_蘇生(100)
			ELSE
				WSTR:(K++) = 近づいてみると、突然魔石から温かな光が湧き出した。
				WSTR:(K++) = 光に包まれた君たちの傷が癒えていく……。
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが１００回復した！
				CALL メッセージ欄表示用関数()
				CALL 探索中全体回復_ＨＰ(100)
				CALL 口上変数初期化
				WSTR:(K++) = どうやら光の魔石に魔力が溜まりすぎていたようだ。
				WSTR:(K++) = 魔力を使い切った魔石はただの石ころになってしまっている……。
				KSTR:(K++) = 魔法知識があればもっと有効に使えたかもしれないが……気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
			KSTR:(K++) = 魔法知識があれば利用出来たかもしれないが……。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_機械知識イベ１
#DIMS ドロップアイテム

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = 地面に横たわり、朽ちかけたアイアンゴーレムを発見した。
	KSTR:(K++) = 近づいてみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("機械知識", 1)
	LOCAL = RESULT
	IF LOCAL > -1
		KSTR:(K++) = BUTTON_[%CALLNAME:LOCAL%が遠くから観察してみる]
	ELSE
		LOCAL = 0
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			IF RAND:2
				WSTR:(K++) = 近づいてよく見てみると、朽ちているのは表面だけで内部の機構はまだ使うことが出来そうだ。
				WSTR:(K++) = 分解して状態が良い部品を回収しよう。
				ドロップアイテム = %ランダム素材名("ダンジョン素材", RAND:3)%
				LOCAL = RAND:3 + 2
				WSTR:(K++) = %CALLNAME:PLAYER%は%ドロップアイテム%を{LOCAL}個手に入れた！
				CALL 素材入手処理(ドロップアイテム, LOCAL)
			ELSE
				WSTR:(K++) = 近づいてみると、突然ゴーレムの機体が異音を立てて爆発した！
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが{ダンジョン階層記録 * 50}減少した！
				CALL メッセージ欄表示用関数()
				CALL 探索中全体ダメージ_ＨＰ_非致死(ダンジョン階層記録 * 50)
				CALL 口上変数初期化
				WSTR:(K++) = どうやら朽ちているように見えて、動力部だけは生きていたようだ。
				WSTR:(K++) = 部品の類も吹っ飛んでしまっており、回収できそうな部品は残っていない。
				KSTR:(K++) = 収穫がなかったことを残念に思いながら、気を取り直して君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASE "[いいえ]"
			WSTR:(K++) = 下手に触ると何が起こるかわからず危険だ。放置しよう。
		CASE @"[%CALLNAME:LOCAL%が遠くから観察してみる]"
			IF RAND:2
				WSTR:(K++) = 露出している機械部分は光を失っており、耳を澄ませてみても駆動音は聞こえない…
				WSTR:(K++) = %CALLNAME:LOCAL%はあのゴーレムは安全だと判断した。
				WSTR:(K++) = 改めて近づいてみると、朽ちているのは表面だけで内部の機構はまだ使うことが出来そうだ。
				WSTR:(K++) = 分解して状態が良い部品を回収しよう。
				ドロップアイテム = %ランダム素材名("ダンジョン素材", RAND:3)%
				LOCAL = RAND:3 + 2
				WSTR:(K++) = %CALLNAME:PLAYER%は%ドロップアイテム%を{LOCAL}個手に入れた！
				CALL 素材入手処理(ドロップアイテム, LOCAL)
			ELSE
				WSTR:(K++) = 露出している機械部分は光を失っているが、耳を澄ませてみると微かに駆動音が聞こえる…
				WSTR:(K++) = %CALLNAME:LOCAL%はあのゴーレムは危険だと判断した。
				KSTR:(K++) = 遠くから石を投げて刺激してみると、突然ゴーレムの機体が異音を立てて爆発した！_PAGE
				WSTR:(K++) = どうやら朽ちているように見えて、動力部だけは生きていたようだ。
				WSTR:(K++) = 部品の類も吹っ飛んでしまっており、回収できそうな部品は残っていない。
				KSTR:(K++) = 収穫がなかったことを残念だが、安全に処理出来たことに安堵しながら君たちは先に進む。
			ENDIF
			ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_機械知識イベ２
#DIMS ドロップアイテム

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちは野生の獣型ゴーレムと遭遇した。
	WSTR:(K++) = 咄嗟に戦闘態勢を取るが、ゴーレムは動かない。どうやらこちらへの敵意はないようだ。
	KSTR:(K++) = 近づいてみますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("機械知識", 1)
	LOCAL = RESULT
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			WSTR:(K++) = 近づいてよく見てみると、ちかちかとランプが規則的に点滅していることがわかる。
			IF LOCAL > -1
				WSTR:(K++) = %CALLNAME:LOCAL%が点滅するパターンを数えてみると、騎空艇でよく使われる通信の合図と一致することがわかった。
				WSTR:(K++) = 解読すると……「コ・コ・ホ・レ・ワ・ン・ワ・ン」と言っているらしい……。
				ドロップアイテム = %TEXTR("渦琥珀/オルディネシュタイン/宝晶原石/星晶の欠片")%
				WSTR:(K++) = 試しに地面を掘ってみると、地中から%ドロップアイテム%が出てきた！
				KSTR:(K++) = %CALLNAME:LOCAL%たちは%ドロップアイテム%を1個手に入れた！_PAGE
				CALL 素材入手処理(ドロップアイテム, 1)
				WSTR:(K++) = ゴーレムは満足したのかランプを消し、その場に横たわって休憩し始めた。
				KSTR:(K++) = 手に入れた宝石をありがたく貰い、君たちはゴーレムから離れて先に進む。
			ELSE
				WSTR:(K++) = なにかを伝えようとしているみたいだが、%CALLNAME:PLAYER%たちにはわからなかった……
				WSTR:(K++) = 機械の知識がある者ならわかるかもしれないが、今は解読する方法はない。
				KSTR:(K++) = 仕方なくゴーレムと別れ、君たちは先に進む。
			ENDIF
		CASE "[いいえ]"
			WSTR:(K++) = 敵対しないなら無理に関わる必要もないだろう。
			KSTR:(K++) = 君たちはゴーレムから離れ、先に進む。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_錬金知識イベ１
#DIMS ドロップアイテム
#DIM 知識２
#DIM 知識１
#DIM 薬効果
#DIM 飲むキャラ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、森から謎の老婆が姿を現した。
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	WSTR:(K++) = 「ふぇっふぇっふぇっ……良い薬があるよ。飲んでみるかい？」
	;薬の効果をここで決定しておく
	薬効果 = RAND:4
	;0:ダメージ　1:何も起こらない　2:HP回復　3:MP回復
	飲むキャラ = 味方ランダム選出()
	CALL メッセージ欄表示用関数(,"怪しい老婆",,0)
	CALL 口上変数初期化
	WSTR:(K++) = 老婆が差し出した薬はボコボコと泡を出しており、どう見ても怪しい……。
	$選択ループ
	KSTR:(K++) = 薬を飲みますか？
	KSTR:(K++) = BUTTON_[はい]
	KSTR:(K++) = BUTTON_[いいえ]
	CALL 知識技能所持者検索("錬金知識", 2)
	知識２ = RESULT
	CALL 知識技能所持者検索("錬金知識", 1)
	知識１ = RESULT
	IF 知識２ >= 0
		KSTR:(K++) = BUTTON_[薬の効果を鑑定する]
	ELSEIF 知識１ >= 0
		KSTR:(K++) = BUTTON_[薬の効果を推理する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[はい]"
			WSTR:(K++) = 「それじゃあ、グッと行きな。一気にね。ふぇっふぇっふぇっ……」
			CALL メッセージ欄表示用関数(,"怪しい老婆",,0)
			CALL 口上変数初期化
			SELECTCASE 薬効果
				CASE 0
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、エグ味と苦みが口の中を暴れまわる……！
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%のＨＰが1になった！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:ＨＰ = 1
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = 怪しい物は気軽に飲まない方がいい……そんな教訓を得て、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 1
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、特に何の味もしない……。
					WSTR:(K++) = というか、ただの色が付いた水のようだ。
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = 何だったんだろうか……と不思議に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 2
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、身体の疲れや痛みが消えていく……。
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%のＨＰが全快した！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:ＨＰ = BATTLE_STATE:飲むキャラ:最大ＨＰ
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = お礼を言う暇もなかったことを残念に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
				CASE 3
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%がぐいっと薬を飲むと、身体中に力が湧き上がる！
					WSTR:(K++) = %CALLNAME:(BATTLE_STATE:飲むキャラ:0)%の奥義ゲージが最大になった！
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
					BATTLE_STATE:飲むキャラ:奥義ゲージ = BATTLE_STATE:飲むキャラ:ゲージ最大値
					WSTR:(K++) = %CALLNAME:PLAYER%たちが老婆の方を振り向くと、いつの間にかどこかへ消えてしまっていた。
					KSTR:(K++) = お礼を言う暇もなかったことを残念に思いながら、%CALLNAME:PLAYER%たちは探索に戻る。
			ENDSELECT
		CASE "[いいえ]"
			WSTR:(K++) = 何もわからない薬を飲むほど%CALLNAME:PLAYER%たちは無鉄砲ではない。
			KSTR:(K++) = 老婆の申し出を断り、足早にその場を離れた。
		CASE "[薬の効果を鑑定する]"
			SELECTCASE 薬効果
				CASE 0
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 薬を飲むと体力が大幅に削られてしまう気がする……と%CALLNAME:知識２%は判断したようだ
				CASE 1
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = これは薬ではなくただの水ではないか……と%CALLNAME:知識２%は判断したようだ
				CASE 2
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 体力を大きく回復する薬のような気がする……と%CALLNAME:知識２%は判断したようだ
				CASE 3
					WSTR:(K++) = %CALLNAME:知識２%がじっくりと薬を観察してみる……
					WSTR:(K++) = 奥義ゲージを大きく回復する薬のような気がする……と%CALLNAME:知識２%は判断したようだ
			ENDSELECT
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			GOTO 選択ループ
		CASE "[薬の効果を推理する]"
			SELECTCASE 薬効果
				CASE 0, 1
					WSTR:(K++) = %CALLNAME:知識１%がじっくりと薬を観察してみる……
					WSTR:(K++) = あまり良い効果ではないような気がする……と%CALLNAME:知識１%は判断したようだ
				CASE 2, 3
					WSTR:(K++) = %CALLNAME:知識１%がじっくりと薬を観察してみる……
					WSTR:(K++) = なんだか良い効果のような気がする……%CALLNAME:知識１%は判断したようだ
			ENDSELECT
			CALL メッセージ欄表示用関数(,,,0)
			CALL 口上変数初期化
			GOTO 選択ループ
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_錬金知識イベ２
#DIMS ドロップアイテム
#DIM 知識１
#DIM 薬効果

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、突然周囲が濃い霧に包まれていく……
	WSTR:(K++) = 天候が変わったのだろうか、瞬く間に一歩先も見えないほどになってしまった。
	$選択ループ
	KSTR:(K++) = どうしたものだろうか？
	KSTR:(K++) = BUTTON_[とにかく進んでみる]
	KSTR:(K++) = BUTTON_[霧が晴れるまでここで待つ]
	CALL 知識技能所持者検索("錬金知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[錬金術で霧を払う]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[とにかく進んでみる]"
			WSTR:(K++) = 前に進めばそのうち霧から出られるだろう。とりあえず進んでみる。
			WSTR:(K++) = …………
			SELECTCASE RAND:3
				CASE 0, 1
					WSTR:(K++) = …………ダメだ！　霧の中から出られそうにない。
					KSTR:(K++) = %CALLNAME:PLAYER%たちは疲労でＨＰが 100減少した。
					CALL メッセージ欄表示用関数()
					CALL 口上変数初期化
					
					CALL 探索中全体ダメージ_ＨＰ_非致死(100)
					GOTO 選択ループ
				CASE 2
					WSTR:(K++) = …………なんとか霧の中から抜け出すことに成功したようだ。
					KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
			ENDSELECT
		CASE "[霧が晴れるまでここで待つ]"
			WSTR:(K++) = 下手に動き回るよりは、時間が掛かってもここで待つ方がいいだろう。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは身を寄せ合い、霧が晴れるのをじっと待つ。
			WSTR:(K++) = …………
			KSTR:(K++) = …………_PAGE
			WSTR:(K++) = …………ようやく霧が薄くなってきたようだ。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは精神的に疲弊し、ＭＰが 100減少した。
			KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			CALL 探索中全体ダメージ_ＭＰ(100)
		CASE "[錬金術で霧を払う]"
			WSTR:(K++) = %CALLNAME:知識１%は周囲のありふれた素材を使い、霧を払う粉薬を精製した。
			WSTR:(K++) = 作った粉を周囲に撒くと、風に乗ったまま空気中の水分をどんどん吸着して霧が薄くなっていく……。
			WSTR:(K++) = …………探索に支障がない程度まで霧が薄くなった！
			KSTR:(K++) = 見通しの良くなった道と現在地を地図で確認し、%CALLNAME:PLAYER%たちは探索に戻る。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔物知識イベ１
#DIMS ドロップアイテム
#DIM 知識１
#DIM 薬効果

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、周囲の木々や岩に大きな傷を発見した。
	WSTR:(K++) = 縄張りを示すために魔物が付けた傷のように思えるが、範囲が広い……。
	WSTR:(K++) = この辺りに見合わない強さを持った魔物がうろついているようだ。
	$選択ループ
	KSTR:(K++) = どうしたものだろうか？
	KSTR:(K++) = BUTTON_[放置すると危険だ。魔物を探して討伐する]
	KSTR:(K++) = BUTTON_[慎重を期して一旦ここから離れる]
	CALL 知識技能所持者検索("魔物知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[魔物を待ち伏せして駆除する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[放置すると危険だ。魔物を探して討伐する]"
			WSTR:(K++) = 放置してリゾートの方に出てこられると困る。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは周囲を捜索し、目当ての魔物を見つけ出した。
			KSTR:(K++) = そのまま凶暴な魔物相手に戦いを挑む！
			CALL メッセージ欄表示用関数()

			CALL ランダムエネミーセット関数(2, ダンジョン階層記録 + 5)
			SIF ランダムダンジョン中加護 != ""
				戦闘時_特殊処理フラグ '= ランダムダンジョン中加護
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == -1
				;逃走時
				CALL 口上変数初期化
				CALL 画面再描画
				RETURN 0
			ELSEIF RESULT == 0
				;勝利時
				WSTR:(K++) = %CALLNAME:PLAYER%たちは無事に魔物を討伐した。
				KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に探索に戻った。
			ENDIF
		CASE "[慎重を期して一旦ここから離れる]"
			WSTR:(K++) = いや、まずは準備をしよう。
			KSTR:(K++) = %CALLNAME:PLAYER%たちは一旦この場を離れることにした。
			CALL メッセージ欄表示用関数()
			CALL 口上変数初期化
			CALL 画面再描画
			RETURN 0
		CASE "[魔物を待ち伏せして駆除する]"
			WSTR:(K++) = %CALLNAME:知識１%は周囲の様子を観察し、魔物が移動するルートを割り出した。
			WSTR:(K++) = %CALLNAME:PLAYER%たちはそのルートの近くで待ち伏せ……
			KSTR:(K++) = …………魔物が通りがかった瞬間に一斉攻撃を仕掛けた！_PAGE
			WSTR:(K++) = 魔物はなすすべもなく倒れ、駆除することに成功した。
			KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_魔物知識イベ２
#DIMS ドロップアイテム
#DIM 知識１
#DIM 弱点
#DIM 成功フラグ
#DIM レベルアップフラグ

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	弱点 = RAND:2
	WSTR:(K++) = %CALLNAME:PLAYER%たちが探索していると、特徴的な赤と青の甲殻を持つ魔物が現れた！
	WSTR:(K++) = この魔物は火、もしくは水に弱いが……弱点を間違えると強力な反撃をしてくる習性がある。
	$選択ループ
	KSTR:(K++) = どちらで攻撃すべきだろうか？
	KSTR:(K++) = BUTTON_[火で攻撃だ！]
	KSTR:(K++) = BUTTON_[水で攻撃だ！]
	CALL 知識技能所持者検索("魔物知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[魔物知識で弱点を看破する]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[火で攻撃だ！]", "[水で攻撃だ！]"
			成功フラグ = 0
			IF RESULTS == "[火で攻撃だ！]"
				WSTR:(K++) = %CALLNAME:PLAYER%たちは火属性で攻撃した！
				SIF 弱点 == 0
					成功フラグ = 1
			ELSE
				WSTR:(K++) = %CALLNAME:PLAYER%たちは水属性で攻撃した！
				SIF 弱点 == 1
					成功フラグ = 1
			ENDIF
			IF 成功フラグ
				WSTR:(K++) = 魔物は大きな叫び声を上げ、ゆっくりとその場に倒れた。
				WSTR:(K++) = どうやら正しい弱点を突くことが出来たようだ。
				KSTR:(K++) = 魔物を倒した%CALLNAME:PLAYER%たちは、経験値を{ダンジョン階層記録 * 200}手に入れた！
				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				レベルアップフラグ = 0
				FOR LOCAL, 0, 14
					SIF LOCAL > 3 && LOCAL < 10
						CONTINUE
					SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
						CONTINUE
					基礎BATTLE_STATE:(BATTLE_STATE:LOCAL:キャラ登録番号):蓄積EXP += ダンジョン階層記録 * 200
					CALL レベルアップ処理(BATTLE_STATE:LOCAL:キャラ登録番号)
					SIF レベルアップフラグ < RESULT
						レベルアップフラグ = RESULT
				NEXT
				IF レベルアップフラグ
					;ステータス代入
					CALL 戦闘初期処理_味方
					CALL メッセージ欄表示用関数(,,,0)
					CALL 口上変数初期化
				ENDIF
				KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に戻った。
			ELSE
				WSTR:(K++) = 魔物は大きな叫び声を上げ、興奮した様子で%CALLNAME:PLAYER%たちに襲いかかってきた！
				KSTR:(K++) = %CALLNAME:PLAYER%たちのＨＰが{ダンジョン階層記録 * 30, 4}減少した！
				CALL メッセージ欄表示用関数()
				CALL 口上変数初期化
				
				CALL 探索中全体ダメージ_ＨＰ_非致死(ダンジョン階層記録 * 30)
				WSTR:(K++) = その後、なんとかもう片方の属性を使って魔物を倒すことに成功した。
				KSTR:(K++) = 思わぬ痛手を食らってしまった……次は気をつけよう。%CALLNAME:PLAYER%たちは気を取り直し、探索に戻った。
			ENDIF
		CASE "[魔物知識で弱点を看破する]"
			WSTR:(K++) = %CALLNAME:知識１%は魔物の立ち回りを観察し、%属性数値文字列変換(弱点)%属性が弱点だと見破った！
			WSTR:(K++) = %CALLNAME:PLAYER%たちが正しい属性で攻撃すると、魔物は大きな叫び声を上げてゆっくりとその場に倒れる。
			WSTR:(K++) = 魔物はなすすべもなく倒れ、駆除することに成功した。
			KSTR:(K++) = これで幾らか周囲は安全になっただろう。%CALLNAME:PLAYER%たちは探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL メッセージ欄表示用関数()
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	CALL 口上変数初期化
ENDIF
CALL 画面再描画


@イベント_リゾート島開拓作業_ランダム_釣り好き１
#DIMS 素材名
#DIM 知識１

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、透き通った綺麗な川を見つけた。
	WSTR:(K++) = 川の中には何匹かの魚が泳いでいる様子が見える。丸々として元気に太った魚だ。
	CALL 知識技能所持者検索("釣り好き", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = %CALLNAME:知識１%が持ってきていた釣り竿を使い、%CALLNAME:MASTER%たちは少しの間魚釣りに興じた。
		WSTR:(K++) = …………
		WSTR:(K++) = %CALLNAME:知識１%は十分な数の魚を釣ることが出来た！
		素材名 = %ランダム素材名("食物素材", , , "魚")%
		WSTR:(K++) = %素材名%を３個手に入れた！
		WSTR:(K++) = %CALLNAME:MASTER%たちは魚を締めて腐らぬよう保管した後、探索に戻った。
		CALL 素材入手処理(素材名, 3)
	ELSE
		WSTR:(K++) = しかし、今日は誰も釣りの道具を持ってきていなかった。
		WSTR:(K++) = 釣りを楽しむのはまたの機会にしよう。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_料理人１
#DIM 知識１
#DIM 回復量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、珍しいきのこを見つけた。
	WSTR:(K++) = 美味であると評判だが、調理法を間違えると毒を出してしまうという。
	CALL 知識技能所持者検索("料理人", 2)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = %CALLNAME:知識１%はちょうど、下処理についての知識があるようだ。
		WSTR:(K++) = アウトドア用の調理器具をいくつか使い、きのこの調理を開始する。
		WSTR:(K++) = …………
		WSTR:(K++) = %CALLNAME:知識１%が作ったきのこ料理に、皆で舌鼓を打った！
		回復量 = ダンジョン階層記録 * 50
		WSTR:(K++) = 全員のＨＰが{回復量, 4}回復した！
		CALL メッセージ欄表示用関数(,,,0)
		CALL 口上変数初期化
		CALL 探索中全体回復_ＨＰ(回復量)
		WSTR:(K++) = %CALLNAME:MASTER%たちは小腹を満たして満足しながら、探索に戻った。
	ELSE
		WSTR:(K++) = 残念ながら、誰も調理法については詳しくないようだ。
		WSTR:(K++) = 毒に当たっても困る。何もせず探索に戻ろう。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_高貴１
#DIM 知識１
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、ロイヤルな雰囲気を纏った鳥と出会った。
	WSTR:(K++) = この鳥は魔物の一種で、様々な色に輝く尾羽根を広げてロイヤルさを競う習性があるらしい。
	KSTR:(K++) = ロイヤルな鳥は%CALLNAME:MASTER%たちの姿を一瞥する。_PAGE
	CALL 知識技能所持者検索("高貴", 2)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = …………鳥の目線が%CALLNAME:知識１%で止まる。
		WSTR:(K++) = しばらくじっと見つめた後、ロイヤルな鳥は負けを認めるように%CALLNAME:知識１%に頭を下げた。
		WSTR:(K++) = どうやらロイヤルさで勝利したらしい。
		WSTR:(K++) = ロイヤルな鳥は勝者を称えるように、懐から贈り物を差し出してきた。
		素材名 = %ランダム素材名("贈答アイテム", , , "アクセサリ")%
		CALL 素材入手処理(素材名, 1)
		KSTR:(K++) = %CALLNAME:知識１%は%素材名%を手に入れた！_PAGE
		WSTR:(K++) = %CALLNAME:MASTER%たちは去っていくロイヤルな鳥を見送り、探索に戻る。
	ELSE
		WSTR:(K++) = …………どうやらロイヤルな鳥は自分が一番ロイヤルだという結論に達したようだ。
		WSTR:(K++) = %CALLNAME:MASTER%たちを鼻で笑い、しゃなりしゃなりと優雅にどこかへ去っていく。
		WSTR:(K++) = なんだか釈然としない気がしつつも、%CALLNAME:MASTER%たちは探索に戻る。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_踊り子１
#DIM 知識１
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、突然森からゴブリンたちが現れた！
	WSTR:(K++) = ゴブリンたちは太鼓を鳴らし笛を吹き、情熱的なダンスで踊り狂う！
	KSTR:(K++) = 一通り踊ったゴブリンたちは決めポーズを取りながら、%CALLNAME:MASTER%たちを挑発的に見つめた。_PAGE
	CALL 知識技能所持者検索("踊り子", 2)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = 対抗して%CALLNAME:知識１%が足でリズムを取りながら、見事な踊りを披露する！
		WSTR:(K++) = ゴブリンたちは%CALLNAME:知識１%の踊りに合わせるように楽器を鳴らしながら共に踊る！
		WSTR:(K++) = …………ひとしきり踊り終わった後、ゴブリンたちは健闘を称えるように贈り物を差し出してきた。
		素材名 = %ランダム素材名("贈答アイテム", , , "酒")%
		CALL 素材入手処理(素材名, 1)
		KSTR:(K++) = %CALLNAME:知識１%は%素材名%を手に入れた！_PAGE
		WSTR:(K++) = ゴブリンたちはいい笑顔のまま森へと戻っていった。何だったんだろうか。
		WSTR:(K++) = %CALLNAME:MASTER%たちは困惑しながらもゴブリンたちを見送り、探索に戻る。
	ELSE
		WSTR:(K++) = …………%CALLNAME:MASTER%たちが動けないままでいると、ゴブリンたちは露骨にがっかりしているようだ。
		WSTR:(K++) = ため息をつきながら肩を落とし、とぼとぼと森の中へと帰っていった。
		WSTR:(K++) = なんだか申し訳ない気持ちになりながら、%CALLNAME:MASTER%たちは探索に戻る。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_歴史知識１
#DIM 知識１
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、崖のようになっている地層から妙な石を見つけた。
	WSTR:(K++) = なにか模様のようなものが刻まれているが、魔力などは感じない。
	KSTR:(K++) = 偶然に出来ただけの石ころだろうか？_PAGE
	CALL 知識技能所持者検索("歴史知識", 2)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = %CALLNAME:知識１%が石ころをじっと見つめると……この文様は覇空戦争時代のものだと看破した。
		WSTR:(K++) = 当時の歴史を暗号にして記録した一族が残した、言い伝えの断片だろう。
		WSTR:(K++) = 空の世界ではあらゆる場所から出土するものだが、その性質上、叡智の殿堂がそれなりの値段で買い取っている。
		KSTR:(K++) = 売却すれば小遣い稼ぎ程度の資金にはなるだろう_PAGE
		WSTR:(K++) = %CALLNAME:MASTER%たちは後で売却しておこう、と石を懐に入れた。
		WSTR:(K++) = %CALLNAME:MASTER%は{ダンジョン階層記録 * 150}ルピ手に入れた！
		MONEY += ダンジョン階層記録 * 150
	ELSE
		WSTR:(K++) = %CALLNAME:MASTER%たちは特に気にせず、石ころを放り捨てて探索に戻った。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_絵師１
#DIM 知識１
#DIM ダメージ量

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、行ったり来たりで入り組んだ地形に迷い込んでしまった。
	WSTR:(K++) = マッピングした地図と周囲を見比べてみるが、どうにも書き間違えているような気がする。
	KSTR:(K++) = もう一度周囲を探索し直した方がいいだろうか……？_PAGE
	CALL 知識技能所持者検索("絵師", 2)
	知識１ = RESULT
	IF 知識１ > 0
		WSTR:(K++) = 悩む%CALLNAME:MASTER%の横から%CALLNAME:知識１%が地図を見ると、道の書き方を間違えていることに気づいたようだ。
		WSTR:(K++) = %CALLNAME:知識１%は地面にさらさらと手本を描き、正しい地図を示してくれた。
		WSTR:(K++) = 確認してみると、確かに%CALLNAME:知識１%の描いた手本が正しいようだ。
		WSTR:(K++) = %CALLNAME:MASTER%は%CALLNAME:知識１%にお礼を言い、入り組んだ地形を抜けて探索に戻る。
	ELSEIF 知識１ == MASTER
		WSTR:(K++) = もう一度%CALLNAME:MASTER%が地図を確認すると、繋げる道を間違えていたことが判明した。
		WSTR:(K++) = %CALLNAME:MASTER%は地面にさらさらと試し書きをしてみると、やはりこちらが正しいようだ。
		WSTR:(K++) = 改めて地図を正しく書き直し、%CALLNAME:MASTER%たちは入り組んだ地形を抜けて探索に戻る。
	ELSE
		WSTR:(K++) = このまま進んで、迷って遭難でもしたら目も当てられない。
		WSTR:(K++) = %CALLNAME:MASTER%たちは周囲を改めて一歩一歩探索し直した……
		ダメージ量 = ダンジョン階層記録 * 10
		KSTR:(K++) = ややこしい探索で時間を浪費し、全員のＨＰが{ダメージ量, 4}減少した。
		;HPバーの表示タイミングを調整するためここで一旦メッセージ表示
		CALL メッセージ欄表示用関数()
		CALL 口上変数初期化
		
		CALL 探索中全体ダメージ_ＨＰ_非致死(ダメージ量)
		WSTR:(K++) = %CALLNAME:MASTER%たちはようやく完成した地図をしまい、探索に戻る。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_歌唱技能１
#DIM 知識１
#DIM 知識２
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、森の奥から綺麗な歌声が聞こえてきた。
	WSTR:(K++) = 今までに聞いたことのないような美しく魅惑的な歌だ。
	KSTR:(K++) = %CALLNAME:MASTER%たちは興味を引かれ、歌声の方へと歩いていく……_PAGE
	CALL 知識技能所持者検索("歌唱技能", 2)
	知識１ = RESULT
	CALL 知識技能所持者検索("歌唱技能", -1)
	知識２ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = %CALLNAME:知識１%は違和感を覚え、聞こえてくる声に合わせて歌い始める。
		WSTR:(K++) = すると聞こえていた歌声は止み、代わりにくすくすと楽しそうな笑い声が聞こえてくる。
		素材名 = %ランダム素材名("贈答アイテム", , , "花")%
		CALL 素材入手処理(素材名, 1)
		WSTR:(K++) = そして%CALLNAME:知識１%の上に、ふわりと%素材名%が落ちてきた。
		KSTR:(K++) = %CALLNAME:知識１%は%素材名%を手に入れた！_PAGE
		WSTR:(K++) = あの歌声は恐らく妖精たちが遊んでいる声だったのだろう。
		WSTR:(K++) = このプレゼントは一緒に歌ってくれたことへのお礼のようだ。
		WSTR:(K++) = %CALLNAME:MASTER%たちはどこかにいる妖精たちにお礼を言い、探索に戻る。
	ELSEIF 知識２ >= 0
		WSTR:(K++) = %CALLNAME:知識２%は違和感を覚え、聞こえてくる声に合わせて歌い始める。
		WSTR:(K++) = すると聞こえていた歌声は止み、代わりに苦しむような悲鳴が聞こえてきた！
		WSTR:(K++) = あの歌声は恐らく妖精たちが遊んでいる声だったのだろうが……。
		WSTR:(K++) = %CALLNAME:知識２%の歌声に耐えきれずに逃げていってしまったらしい。
		WSTR:(K++) = %CALLNAME:MASTER%はどこかにいる妖精たちに心の中で謝罪して、探索に戻る。
	ELSE
		WSTR:(K++) = しかし、どれだけ歩いても歌声の主は見つからない。
		WSTR:(K++) = その代わり、どこからかくすくすと楽しそうな笑い声が聞こえてくる。
		WSTR:(K++) = あの歌声は恐らく妖精たちが遊んでいる声で、姿を隠して人間をからかっているのだろう。
		WSTR:(K++) = %CALLNAME:MASTER%たちは妖精ならしょうがないなと諦め、探索に戻る。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_経営知識１
#DIM 知識１
#DIMS 素材名
#DIM 品番号

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、島の開拓依頼を受けた騎空士と出会った。
	WSTR:(K++) = 騎空士は商人を本業としており、依頼を受けながら島々を旅して商品を売買しているのだとか。
	WSTR:(K++) = 興味があれば、割高にはなるが手持ちの薬などを売ってくれるらしい。
	KSTR:(K++) = どうしようか？
	KSTR:(K++) = BUTTON_[薬を買う]
	KSTR:(K++) = BUTTON_[今は必要ない]
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[薬を買う]"
			;道具屋処理
			CALL 知識技能所持者検索("経営知識", 2)
			知識１ = RESULT
			IF 知識１ >= 0
				WSTR:(K++) = 商品を買う前に、%CALLNAME:知識１%が商人と交渉を始めた。
				WSTR:(K++) = 幾度かのやり取りをした後、商品を値切ることに成功したようだ。
				WSTR:(K++) = かなわんなぁ、という顔をした商人は薬を並べていく。
				CALL メッセージ欄表示用関数(,,,0)
				CALL 口上変数初期化
				品番号 = 0
				汎用アイテム購入用_序文 = ■ダンジョンの商人<br>　「まいど！　たくさん買うてってや！」
				汎用アイテム購入用_品揃え登録:(品番号++) = ポーション
				汎用アイテム購入用_品揃え登録:(品番号++) = マナポーション
				汎用アイテム購入用_品揃え登録:(品番号++) = 胆力の薬
				汎用アイテム購入用_品揃え登録:(品番号++) = 蘇生薬
				汎用アイテム購入用_品揃え登録:(品番号++) = 解毒薬
				CALL 汎用アイテム購入画面処理(0)
			ELSE
				品番号 = 0
				汎用アイテム購入用_序文 = ■ダンジョンの商人<br>　「まいど！　たくさん買うてってや！」
				汎用アイテム購入用_品揃え登録:(品番号++) = ポーション,1600,ルピ
				汎用アイテム購入用_品揃え登録:(品番号++) = マナポーション,12000,ルピ
				汎用アイテム購入用_品揃え登録:(品番号++) = 胆力の薬,1000,ルピ
				汎用アイテム購入用_品揃え登録:(品番号++) = 蘇生薬,6000,ルピ
				汎用アイテム購入用_品揃え登録:(品番号++) = 解毒薬,800,ルピ
				CALL 汎用アイテム購入画面処理(0)
			ENDIF

			WSTR:(K++) = 必要な物はこんなところだろうか。
			WSTR:(K++) = %CALLNAME:PLAYER%たちはお礼を言う商人と別れ、探索に戻った。
		CASE "[今は必要ない]"
			WSTR:(K++) = 今は物資に困ってはいない。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは商人と別れ、探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_水泳技能１
#DIM 知識１
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、湖の中央に浮かぶ小島を見つけた。
	WSTR:(K++) = 小島からは、なんだか妙な魔力を感じる気がする。
	KSTR:(K++) = 出来れば調査をしてみたいところだが……_PAGE
	CALL 知識技能所持者検索("水泳技能", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		WSTR:(K++) = %CALLNAME:知識１%は身軽な格好になり、水の中をすいすいと泳いでいく。
		WSTR:(K++) = 僅かな時間で小島にたどり着き、周囲を調べてみると……特徴的な魔力の籠もった鉱石を見つけた。
		WSTR:(K++) = 鉱石は少し加工するだけで耳飾りとして実用できるだろう。
		CALL 古ぼけた耳飾り抽選取得処理(ダンジョン階層記録 / 10 + 1)
		KSTR:(K++) = %CALLNAME:知識１%は%RESULTS%を手に入れた！_PAGE
		WSTR:(K++) = 再び湖を泳ぎ、%CALLNAME:知識１%は岸に戻ってきた。
		IF 知識１ == MASTER
			WSTR:(K++) = 仲間たちは泳いでくれた%CALLNAME:知識１%を労い、探索に戻る。
		ELSE
			WSTR:(K++) = %CALLNAME:MASTER%たちは泳いでくれた%CALLNAME:知識１%を労い、探索に戻る。
		ENDIF
	ELSE
		WSTR:(K++) = しかし、ボートや橋の類などは見つからない。
		WSTR:(K++) = 残念ながら島に渡る手段はなさそうだ。
		WSTR:(K++) = %CALLNAME:MASTER%たちは小島が気になりながらも諦め、探索に戻る。
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

@イベント_リゾート島開拓作業_ランダム_農業知識１
#DIM 知識１
#DIMS 素材名

CALL 口上変数初期化
IF ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 == "イベント完了"
	KSTR:(K++) = 特に変わった様子はない。
	CALL メッセージ欄表示用関数(,,,0)
ELSE
	;最初に訪れた時
	WSTR:(K++) = %CALLNAME:MASTER%たちが探索していると、ドリアードの幼体を見つけた。
	WSTR:(K++) = ドリアードは生育環境に寄って魔物になったり、森を守る精霊になったりすると聞く。
	KSTR:(K++) = 今の状態からではどちらに育つかはわからないが……。_PAGE
	$選択ループ
	KSTR:(K++) = ドリアードをどうすべきだろうか？
	KSTR:(K++) = BUTTON_[今のうちに駆除する]
	KSTR:(K++) = BUTTON_[放置する]
	CALL 知識技能所持者検索("農業知識", 1)
	知識１ = RESULT
	IF 知識１ >= 0
		KSTR:(K++) = BUTTON_[精霊になるよう環境を整える]
	ENDIF
	CALL メッセージ欄表示用関数(,,,0)
	CALL 口上変数初期化
	$LOOP_MESSAGE
	BINPUTS
	SELECTCASE RESULTS
		CASE "[今のうちに駆除する]"
			WSTR:(K++) = 魔物になって人を傷つける存在になっては危険だ。
			WSTR:(K++) = %CALLNAME:PLAYER%たちはドリアードの幼体を駆除し、探索に戻った。
		CASE "[放置する]"
			WSTR:(K++) = まだ何もしていない相手を屠るのはどうなのだろうか。
			WSTR:(K++) = %CALLNAME:PLAYER%たちはドリアードの幼体をそのままにして探索に戻った。
		CASE "[精霊になるよう環境を整える]"
			WSTR:(K++) = %CALLNAME:知識１%はドリアードの精霊化について知識があるようだ。
			WSTR:(K++) = どうやら日当たりの良いところで、生育期に水の魔力を接種すると精霊になりやすいらしい。
			WSTR:(K++) = %CALLNAME:PLAYER%たちは周囲の木の枝払いをし、魔力を籠めた水を掛けてやる。
			素材名 = %ランダム素材名("食物素材", , , "野菜")%
			CALL 素材入手処理(素材名, 3)
			WSTR:(K++) = 環境を整える際、偶然自生している%素材名%を見つけた。質も悪くなさそうだ、もらっておこう。
			KSTR:(K++) = %CALLNAME:PLAYER%たちは%素材名%を３個手に入れた！_PAGE
			WSTR:(K++) = 環境を整え、心なしかドリアードの幼体も元気になったように見える。
			WSTR:(K++) = いずれ精霊になるように願いながら、%CALLNAME:PLAYER%たちは探索に戻った。
		CASEELSE
			CLEARLINE 1
			REUSELASTLINE  
			GOTO LOOP_MESSAGE
	ENDSELECT
	CALL メッセージ欄表示用関数(,,,0)
	CALL 接続ルート全開放処理((ダンジョン現在位置:0), (ダンジョン現在位置:1))
	ランダムダンジョン配列:(ダンジョン現在位置:0):(ダンジョン現在位置:1):イベント状態 = イベント完了
	CALL 口上変数初期化
ENDIF
CALL 画面再描画

