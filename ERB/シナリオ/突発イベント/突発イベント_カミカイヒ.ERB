
@イベント発生条件_突発イベント_カミカイヒ
;開放条件を満たしたら1を返すこと
#DIM キャラ番号_キクル
;イベント消滅日数渡し = 10
;イベント消滅確率渡し = 30
;イベント再発生日数渡し = 20
;イベント再発生確率渡し = 50

キャラ番号_キクル = GETCHARA(3024) ;
SIF CFLAG:キャラ番号_キクル:招待不可フラグ != 0
	RETURN 0

RETURN 1

@イベント関数_突発イベント_カミカイヒ(ARG)
#DIM 最大レベル
#DIM 対象キャラ


LOCAL = DT_CELL_GET("各イベント用変数配列", ARG, "イベント再発生CT")
IF LOCAL == 0
	;初回
	DRAWLINE
	PRINTL ［魔物襲撃］
	DRAWLINE

	PRINTFORMW どうやら付近の山や森から魔物が降りてきたらしい。しかし今回の対象はこれまでの報告とはかなり違っている。
	PRINTFORMW 目撃者の情報によると,どうやらこの個体は異常に巨大化の蜘蛛の魔物のようだ。しかも非常に速い。
	PRINTFORMW このあたりでは見かけない魔物だが、キクル・マダンが該当する魔物を知っているようだ。
	PRINTL
	PRINTFORMW キクル「まさかこいつだったのか」
	PRINTL
	PRINTFORMW 彼の説明によると、今回の魔物はおそらく蜘蛛の魔物「ヨケグモ」のネームド。
	PRINTFORMW 通常種は敵意を察知して攻撃を避ける。狙いを定める必要がある攻撃では討伐できない。
	PRINTFORMW さらに一噛みで相手を死に至らしめる猛毒、鉄よりも強靭な糸を持つ。
	PRINTFORMW これは極めて危険な敵である,出撃キャラの選択を慎重に検討した方が良いだろう。
	PRINTL
	PRINTL リゾートに降りてきた魔物と戦います。準備はよろしいですか？
	PRINTBUTTON "[0]はい", 0
	PRINTL
	PRINTBUTTON "[1]いいえ", 1
	PRINTL
	BINPUT
	SELECTCASE RESULT
		CASE 0
		
			PRINTFORMW %CALLNAME:PLAYER%たちはリゾートに襲来した魔物を迎え撃つ！
			
			CALL イベント戦闘初期処理()
			;最大レベル取得
			最大レベル = 0
			VARSET LOCAL
			FOR LOCAL, 0, 14
				SIF LOCAL > 3 && LOCAL < 10
					CONTINUE
				SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
					CONTINUE
				SIF BATTLE_STATE:LOCAL:Lv > 最大レベル
					最大レベル = BATTLE_STATE:LOCAL:Lv
				;キャラ数もカウント
				LOCAL:1 ++
			NEXT
			敵BATTLE_STATE_STR:2:エネミー名 = Lv40_カミカイヒ
			敵BATTLE_STATE_STR:1:エネミー名 = Lv1_深遠な森
			敵BATTLE_STATE_STR:5:エネミー名 = Lv1_深遠な森
			;CALL ランダムエネミーセット関数(LOCAL:1, 最大レベル - 2)
			CALL 雑魚敵遭遇汎用処理
			IF RESULT == 0
				;勝利
				PRINTFORMW %CALLNAME:PLAYER%たちは無事に魔物を掃討した。
				CALL イベント完了フラグ汎用処理("カミカイヒ")
			ELSEIF RESULT == 1
				;全滅
				PRINTW 不覚を取ってしまった。ここは一旦撤退しよう。
			ELSEIF RESULT == -1
				;逃走
				PRINTW 思ったよりも手強いようだ。ここは一旦撤退しよう。
			ENDIF
			CALL ダンジョン終了時処理
		CASE 1
			PRINTW いや、油断は良くない。ここはしっかりと準備をしてからにしよう。
	ENDSELECT
;ELSE
;	;二回目以降
;	DRAWLINE
;	PRINTL ［魔物袭击］
;	DRAWLINE
;	PRINTW
;	PRINTFORMW 又有魔物侵袭至度假区。
;	PRINTFORMW 需在受害前迅速击溃。
;	PRINTL
;	PRINTL 将与袭击度假区的魔物交战。准备就绪了吗？
;	PRINTBUTTON "[0]确定", 0
;	PRINTL
;	PRINTBUTTON "[1]取消", 1
;	PRINTL
;	BINPUT
;	SELECTCASE RESULT
;		CASE 0
;			PRINTFORMW %CALLNAME:PLAYER%一行迎击来袭魔物！
;
;			CALL イベント戦闘初期処理()
;			;最大レベル取得
;			最大レベル = 0
;			VARSET LOCAL
;			FOR LOCAL, 0, 14
;				SIF LOCAL > 3 && LOCAL < 10
;					CONTINUE
;				SIF BATTLE_STATE:LOCAL:キャラ登録番号 < 1
;					CONTINUE
;				SIF BATTLE_STATE:LOCAL:Lv > 最大レベル
;					最大レベル = BATTLE_STATE:LOCAL:Lv
;				;キャラ数もカウント
;				LOCAL:1 ++
;			NEXT
;			CALL ランダムエネミーセット関数(LOCAL:1, 最大レベル - 2)
;			CALL イベント中戦闘用処理()
;			IF RESULT == 0
;				;勝利
;				PRINTL 
;				PRINTL 
;				PRINTFORMW %CALLNAME:PLAYER%一行顺利清剿魔物。
;				CALL イベント完了フラグ汎用処理("カミカイヒ")
;			ELSEIF RESULT == 1
;				;全滅
;				PRINTL 
;				PRINTL 
;				PRINTW 遭遇惨败，暂且撤退重整旗鼓。
;			ELSEIF RESULT == -1
;				;逃走
;				PRINTL 
;				PRINTL 
;				PRINTW 敌方实力超乎预期，暂且撤退从长计议。
;			ENDIF
;			CALL ダンジョン終了時処理
;		CASE 1
;			PRINTW 不，不能掉以轻心。还是充分准备后再行动吧。
;	ENDSELECT
ENDIF








