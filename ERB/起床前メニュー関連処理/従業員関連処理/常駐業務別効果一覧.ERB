;----------------------------------------------------
;常駐業務ごとの効果を処理する
;----------------------------------------------------

@常駐業務効果_ロビー受付(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"改修中のため一時的にロビー受付の効果を封印しています。<br>"
		;経験値取得とレベル上昇
		LOCALS = ロビー受付
		LOCAL = GETNUM(常駐業務レベル, "ロビー受付")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:ロビー受付 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_バーテンダー(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"改修中のため一時的にバーテンダーの効果を封印しています。<br>"
		;経験値取得とレベル上昇
		LOCALS = バーテンダー
		LOCAL = GETNUM(常駐業務レベル, "バーテンダー")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:バーテンダー + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_司書(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"改修中のため一時的に司書の効果を封印しています。<br>"
		;経験値取得とレベル上昇
		LOCALS = 司書
		LOCAL = GETNUM(常駐業務レベル, "司書")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:司書 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_プール監視員(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"改修中のため一時的にプール監視員の効果を封印しています。<br>"
		;経験値取得とレベル上昇
		LOCALS = プール監視員
		LOCAL = GETNUM(常駐業務レベル, "プール監視員")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:プール監視員 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_漁師(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIMS 入手名
#DIM 候補数
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		SELECTCASE RAND:3
			CASE 0
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%は漁師の仕事を頑張っています。（その他報告へ）<br>"
			CASE 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%はのんびり船に揺られています。（その他報告へ）<br>"
			CASE 2
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ%は何かの魚を釣り上げたようです。（その他報告へ）<br>"
		ENDSELECT
		候補数 = DT_SELECT("所持素材データベース", "素材カテゴリ = '食物素材' And 食材分類 = '魚'")
		RSTR:漁師結果一時保存 += @"<br>%CALLNAME:対象キャラ%が更に"
		FOR LOCAL, 0, 常駐業務レベル:対象キャラ:漁師 + 1
			;とりあえず完全ランダム
			入手名 '= DT_CELL_GETS("所持素材データベース", RESULT:(RAND:候補数 + 1), "素材アイテム名", 1)
			CALL 素材入手処理(入手名, 1)
			SIF LOCAL > 0
				RSTR:漁師結果一時保存 += "、"
			RSTR:漁師結果一時保存 += @"%入手名%"
		NEXT
		RSTR:漁師結果一時保存 += "を釣り上げた！"
		;経験値取得とレベル上昇
		LOCALS = 漁師
		LOCAL = GETNUM(常駐業務レベル, "漁師")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:漁師 + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_シーガイド(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "経験値取得"
		業務別報告文字列:2 += @"改修中のため一時的にシーガイドの効果を封印しています。<br>"
		;経験値取得とレベル上昇
		LOCALS = シーガイド
		LOCAL = GETNUM(常駐業務レベル, "シーガイド")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:LOCALS < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:シーガイド + 1)
				常駐業務レベル:対象キャラ:LOCALS += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の%LOCALS%レベルがLv{常駐業務レベル:対象キャラ:LOCALS}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:LOCALS >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：%LOCALS%レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_道具屋(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:道具屋 + 1) * (常駐業務レベル:対象キャラ:道具屋 + 1) * (常駐業務レベル:対象キャラ:道具屋 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000), 24, LEFT%に常駐する%CALLNAME:対象キャラ, 16, LEFT%の働きで%NUM_FORMAT(業務量), 6%ルピ分の利益が上がりました。<br>"
		RESULTS = 　%@"常駐従業員「%CALLNAME:対象キャラ%」", 32, LEFT%：%NUM_FORMAT(業務量), 6%ルピ<br>
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "道具屋")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:道具屋 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:道具屋 + 1)
				常駐業務レベル:対象キャラ:道具屋 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の道具屋レベルがLv{常駐業務レベル:対象キャラ:道具屋}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:道具屋 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：道具屋レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_土産物屋(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:土産物屋 + 1) * (常駐業務レベル:対象キャラ:土産物屋 + 1) * (常駐業務レベル:対象キャラ:土産物屋 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%に常駐する%CALLNAME:対象キャラ, 18, LEFT%の働きで%NUM_FORMAT(業務量), 6%ルピ分の利益が上がりました。<br>"
		RESULTS = 　常駐従業員「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%ルピ
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "土産物屋")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:土産物屋 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:土産物屋 + 1)
				常駐業務レベル:対象キャラ:土産物屋 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の土産物屋レベルがLv{常駐業務レベル:対象キャラ:土産物屋}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:土産物屋 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：土産物屋レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT


@常駐業務効果_食事処(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:食事処 + 1) * (常駐業務レベル:対象キャラ:食事処 + 1) * (常駐業務レベル:対象キャラ:食事処 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%に常駐する%CALLNAME:対象キャラ, 18, LEFT%の働きで%NUM_FORMAT(業務量), 6%ルピ分の利益が上がりました。<br>"
		RESULTS = 　常駐従業員「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%ルピ
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "食事処")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:食事処 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:食事処 + 1)
				常駐業務レベル:対象キャラ:食事処 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の食事処レベルがLv{常駐業務レベル:対象キャラ:食事処}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:食事処 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：食事処レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT

@常駐業務効果_装飾品店(対象キャラ, 動作モード)
#DIM 対象キャラ
#DIMS 動作モード
#DIM 業務量
#DIM DYNAMIC レベルアップ判定

SELECTCASE 動作モード
	CASE "ルピ補正"
		業務量 = (常駐業務レベル:対象キャラ:装飾品店 + 1) * (常駐業務レベル:対象キャラ:装飾品店 + 1) * (常駐業務レベル:対象キャラ:装飾品店 + 1) * 滞在キャラ数算出関数() * RAND(95, 106) / 100
		;従業員業務のレポートと、リゾート収支レポートの施設分に書き込む用に文字列保存に入れ込む
		業務別報告文字列:2 += @"%GETPLACENAME(現在仕事:対象キャラ:1 / 10000, 現在仕事:対象キャラ:1 % 10000)%に常駐する%CALLNAME:対象キャラ, 18, LEFT%の働きで%NUM_FORMAT(業務量), 6%ルピ分の利益が上がりました。<br>"
		RESULTS = 　常駐従業員「%CALLNAME:対象キャラ, 18, LEFT%」：%NUM_FORMAT(業務量), 6%ルピ
		施設ルピ補正保存 += 業務量

		RETURN 業務量
	CASE "経験値取得"
		;経験値取得とレベル上昇
		LOCAL = GETNUM(常駐業務レベル, "装飾品店")
		常駐業務経験値:対象キャラ:LOCAL += 1
		IF 常駐業務レベル:対象キャラ:装飾品店 < 5
			IF 常駐業務経験値:対象キャラ:LOCAL >= 仕事レベル経験値テーブル:(常駐業務レベル:対象キャラ:装飾品店 + 1)
				常駐業務レベル:対象キャラ:装飾品店 += 1
				業務別報告文字列:2 += @"%CALLNAME:対象キャラ, 18, LEFT%の装飾品店レベルがLv{常駐業務レベル:対象キャラ:装飾品店}に上昇した！<br>"
				IF 常駐業務レベル:対象キャラ:装飾品店 >= 5
					;仕事レベルは減少しないのでこれでいいはず
					CALL 履歴データベース登録(CFLAG:対象キャラ:人物番号, @"仕事：常駐業務：装飾品店レベルがLv5になった","リゾート")
				ENDIF
				レベルアップ判定 = 1
			ENDIF
		ENDIF
		RETURN レベルアップ判定
ENDSELECT
